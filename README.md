# 📊 授業アンケート分析システム

教員ごとに実施された授業アンケートの生データ（回答ログ）をCSVとしてアップロードし、自動的に集計、可視化、および報告用データのダウンロードができるStreamlitアプリケーションです。

## 🎯 主な機能

- **CSVファイルのアップロード**: Google FormsやMicrosoft Formsから出力されたアンケートデータを簡単にアップロード
- **自動スコアリング**: 4件法の回答（「とてもそう思う」等）を自動的に数値（1-4点）に変換
- **科目別フィルタリング**: 複数科目のデータから特定の科目を選択して分析
- **統計情報の表示**: 質問項目ごとの平均値、回答分布を自動集計
- **データ可視化**: 棒グラフやレーダーチャートで視覚的に分析
- **自由記述の抽出**: 学生からの意見・感想を一覧表示
- **Excelダウンロード**: 集計結果をExcelファイルとしてダウンロード
  - **テンプレート形式**: 事前に用意したテンプレート.xlsxに各教科のデータを書き込んで出力
  - **標準形式**: 選択した科目の集計結果を新規Excelファイルとして出力

## 🚀 クイックスタート

### 必要な環境

- Python 3.10以上

### インストール

```bash
# リポジトリをクローン
git clone https://github.com/itou-daiki/RGB-Student-Evaluation-of-Instruction.git
cd RGB-Student-Evaluation-of-Instruction

# 依存パッケージをインストール
pip install -r requirements.txt
```

### サンプルデータの生成

テスト用のサンプルデータを生成します：

```bash
python generate_sample_data.py
```

`sample_data/` ディレクトリにサンプルCSVファイルが生成されます。

### アプリケーションの起動

```bash
streamlit run app.py
```

ブラウザが自動的に開き、アプリケーションが起動します。

## 📝 使い方

1. **CSVファイルのアップロード**
   - サイドバーの「データアップロード」セクションからCSVファイルを選択
   - 複数ファイルの同時アップロードに対応

2. **科目の選択**
   - 複数科目のデータが含まれる場合、サイドバーで分析したい科目を選択

3. **分析結果の確認**
   - **集計結果タブ**: 質問項目ごとの平均点、回答分布、グラフを表示
   - **自由記述タブ**: 学生からの意見・感想を一覧表示
   - **ダウンロードタブ**: 集計結果をExcelファイルとしてダウンロード
     - **テンプレート形式**: 全教科のデータをテンプレート.xlsxの形式で出力（教科別集計に対応）
     - **標準形式**: 選択した科目のみのデータを新規Excelファイルとして出力

## 📋 入力データの仕様

### 必須カラム

- **科目名**: 科目を識別するためのカラム（「科目名」「科目」「教科名」等）
- **質問項目**: 4件法で回答される質問（自動検出）

### 回答形式（4件法）

質問項目の回答は以下のテキスト形式で記録されている必要があります：

- **4点**: 「とてもそう思う」「当てはまる」等
- **3点**: 「そう思う」「どちらかといえばそう思う」等
- **2点**: 「あまりそう思わない」「どちらかといえばそう思わない」等
- **1点**: 「思わない」「そう思わない」等

### オプショナルカラム

- **出席番号**: 学生の出席番号（集計には使用されません）
- **自由記述**: 意見・感想を記入するカラム

## 🏗️ プロジェクト構造

```
RGB-Student-Evaluation-of-Instruction/
├── app.py                      # Streamlitメインアプリケーション
├── data_processor.py           # データ処理・集計ロジック
├── generate_sample_data.py     # サンプルデータ生成スクリプト
├── requirements.txt            # 依存パッケージリスト
├── テンプレート.xlsx            # 教科別集計結果出力用テンプレート
├── README.md                   # このファイル
└── sample_data/               # サンプルデータ（生成後）
    ├── survey_数学I.csv
    ├── survey_英語コミュニケーションI.csv
    └── ...
```

## 🛠️ 技術スタック

- **Python 3.10+**
- **Streamlit**: Webアプリケーションフレームワーク
- **Pandas**: データ処理・集計
- **Plotly**: インタラクティブなグラフ可視化
- **OpenPyXL**: Excelファイル生成

## 📊 出力データ

### Excelファイルの構成

#### テンプレート形式

テンプレート.xlsxに以下のデータが書き込まれます：

- **概要シート**: 全体および教科別（国語、数学、地歴公民、理科、外国語、保健体育、芸術、家庭）の質問項目ごとの平均値
- **探究シート**: 詳細な集計データ（度数分布など）

教科名は部分一致で自動マッピングされます（例：「数学I」→「数学」、「化学基礎」→「理科」）

#### 標準形式

選択した科目のデータが新規Excelファイルとして出力されます：

1. **サマリー**: 科目名、回答者数、総合平均点などの概要
2. **集計結果**: 質問項目ごとの平均値、回答数、分布
3. **自由記述**: 学生からの意見・感想（空白・「特になし」を除外）

## 🔧 カスタマイズ

### スコアリングマッピングの変更

`data_processor.py` の `SCORE_MAPPING` 辞書を編集することで、回答テキストと点数のマッピングをカスタマイズできます。

### 質問カテゴリの追加

質問項目をカテゴリ別に分類したい場合は、`data_processor.py` にカテゴリマッピングを追加し、`app.py` のグラフ生成ロジックを修正してください。

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 コントリビューション

バグ報告や機能追加の提案は、GitHubのIssuesでお願いします。

## 📧 お問い合わせ

質問や不具合がある場合は、GitHubのIssuesでご報告ください。